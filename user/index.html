<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SomaFy - Kenya's Learning Platform</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="#" class="logo">
                <!-- Using a placeholder image for the logo -->
                <img src="https://placehold.co/40x40/0066cc/ffffff?text=SF" alt="SomaFy Logo" class="logo-img">
                <span>SomaFy</span>
            </a>
            <!-- Hamburger Menu Icon for Mobile -->
            <div class="hamburger-menu" id="hamburger-menu">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>

            <!-- Desktop Navigation -->
            <nav class="desktop-nav">
                <ul>
                    <li><a href="#" class="active">Home</a></li>
                    <li><a href="#papers">Papers</a></li>
                    <li><a href="#setbooks">Setbooks</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
            <div class="user-actions desktop-actions">
                <a href="#" class="sign-in-link"><i class="fas fa-user"></i> Sign In</a>
                <a href="#" class="btn btn-outline">Register</a>
            </div>
        </div>

        <!-- Mobile Menu Overlay -->
        <div class="mobile-menu-overlay" id="mobile-menu-overlay">
            <div class="mobile-menu-content">
                <span class="close-mobile-menu" id="close-mobile-menu">&times;</span>
                <nav class="mobile-nav">
                    <ul>
                        <li><a href="#" class="active">Home</a></li>
                        <li><a href="#papers">Papers</a></li>
                        <li><a href="#setbooks">Setbooks</a></li>
                        <li><a href="#about">About</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </nav>
                <div class="user-actions mobile-actions">
                    <a href="#" class="sign-in-link"><i class="fas fa-user"></i> Sign In</a>
                    <a href="#" class="btn btn-outline">Register</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Kenya's Premier Educational Resource Platform</h1>
            <p>Access curriculum-aligned textbooks, revision papers, and setbooks for all Kenyan education systems</p>
            
            <div class="selector-container">
                <h3>Find Your Learning Materials</h3>
                <div class="selector-row">
                    <div class="selector-group">
                        <label>Select Class/Grade</label>
                        <div class="custom-select">
                            <select id="class-select">
                                <option value="">Select Class/Grade</option>
                                <optgroup label="KCPE">
                                    <option value="std1">Standard 1</option>
                                    <option value="std2">Standard 2</option>
                                    <option value="std3">Standard 3</option>
                                    <option value="std4">Standard 4</option>
                                    <option value="std5">Standard 5</option>
                                    <option value="std6">Standard 6</option>
                                    <option value="std7">Standard 7</option>
                                    <option value="std8">Standard 8</option>
                                </optgroup>
                                <optgroup label="KCSE">
                                    <option value="form1">Form 1</option>
                                    <option value="form2">Form 2</option>
                                    <option value="form3">Form 3</option>
                                    <option value="form4">Form 4</option>
                                </optgroup>
                                <optgroup label="CBC">
                                    <option value="pp1">PP1</option>
                                    <option value="pp2">PP2</option>
                                    <option value="grade1">Grade 1</option>
                                    <option value="grade2">Grade 2</option>
                                    <option value="grade3">Grade 3</option>
                                    <option value="grade4">Grade 4</option>
                                    <option value="grade5">Grade 5</option>
                                    <option value="grade6">Grade 6</option>
                                    <option value="grade7">Grade 7</option>
                                    <option value="grade8">Grade 8</option>
                                    <option value="grade9">Grade 9</option>
                                    <option value="grade10">Grade 10</option>
                                    <option value="grade11">Grade 11</option>
                                    <option value="grade12">Grade 12</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>
                    
                    <div class="selector-group">
                        <label>Select Subject</label>
                        <div class="custom-select">
                            <select id="subject-select" disabled>
                                <option value="">First select a class/grade</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button id="find-resources" class="btn btn-primary">Find Resources</button>
            </div>
        </div>
    </section>

    <!-- Revision Papers Slider Section -->
    <section class="revision-section">
        <h2 class="section-title">Premium Educational Resources</h2>
        <div class="revision-slider">
            <div class="slider-container">
                <!-- Slider items will be dynamically created by JavaScript -->
                <div class="slider-item">
                    <img src="https://placehold.co/1200x500/0066cc/ffffff?text=KCSE+Revision+Papers" alt="KCSE Revision Papers" class="slider-image">
                    <div class="slider-caption">
                        <h3>KCSE Past Papers & Marking Schemes</h3>
                        <p>Prepare for your Kenya Certificate of Secondary Education exams with our extensive collection of past papers.</p>
                    </div>
                </div>
                <div class="slider-item">
                    <img src="https://placehold.co/1200x500/2e8b57/ffffff?text=CBC+Learning+Resources" alt="CBC Learning Resources" class="slider-image">
                    <div class="slider-caption">
                        <h3>CBC Curriculum Aligned Resources</h3>
                        <p>Find interactive and engaging materials for the Competency-Based Curriculum (CBC) for all grades.</p>
                    </div>
                </div>
            </div>
            <button class="slider-arrow prev">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow next">
                <i class="fas fa-chevron-right"></i>
            </button>
            <div class="slider-nav">
                <!-- Navigation dots will be dynamically created by JavaScript -->
                <span class="slider-dot" data-index="0"></span>
                <span class="slider-dot" data-index="1"></span>
            </div>
        </div>
        <div class="revision-cta">
            <a href="#papers" class="btn btn-primary">Explore Resources</a>
        </div>
    </section>

    <!-- Popular Learning Resources Section -->
    <section class="books-section">
        <h2 class="section-title">Popular Learning Resources</h2>
        <div class="books-grid" id="popular-resources-grid">
            <!-- Cards will be rendered here by JavaScript -->
        </div>
    </section>

    <!-- Papers Section -->
    <section id="papers" class="books-section">
        <h2 class="section-title">Past Papers</h2>
        <div class="books-grid" id="past-papers-grid">
            <!-- Cards will be rendered here by JavaScript -->
        </div>
    </section>

    <!-- Setbooks Section -->
    <section id="setbooks" class="books-section">
        <h2 class="section-title">Setbooks</h2>
        <div class="books-grid" id="setbooks-grid">
            <!-- Cards will be rendered here by JavaScript -->
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about-section">
        <div class="about-container">
            <h2>About SomaFy</h2>
            <p>SomaFy is Kenya's premier educational resource platform, providing students and teachers with access to curriculum-aligned textbooks, revision papers, setbooks, and more. Our mission is to make quality learning materials accessible to all, supporting academic excellence and lifelong learning.</p>
            <ul>
                <li>✔️ Access resources for KCPE, KCSE, and CBC</li>
                <li>✔️ Download past papers, setbooks, and general books</li>
                <li>✔️ Easy navigation by class, grade, and subject</li>
                <li>✔️ Secure downloads after payment</li>
            </ul>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="contact-container">
            <div class="contact-form-section">
                <h2>Contact Us</h2>
                <form id="contact-form">
                    <input type="text" id="contact-name" placeholder="Your Name" required>
                    <input type="email" id="contact-email" placeholder="Your Email" required>
                    <textarea id="contact-message" placeholder="Your Message" rows="5" required></textarea>
                    <button type="submit" class="btn btn-primary">Send Message</button>
                    <div id="contact-message-status"></div>
                </form>
            </div>
            <div class="contact-info-section">
                <h3>Contact Information</h3>
                <ul class="contact-info-list">
                    <li><i class="fas fa-envelope"></i> info@somafy.co.ke</li>
                    <li><i class="fas fa-phone"></i> +254 700 123 456</li>
                    <li><i class="fas fa-map-marker-alt"></i> Nairobi, Kenya</li>
                    <li><i class="fas fa-clock"></i> Monday-Friday: 8:00 AM - 5:00 PM</li>
                    <li><i class="fas fa-comments"></i> 24/7 Online Support</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <div class="footer-logo">SomaFy</div>
                <p>Kenya's premier educational resource platform providing quality learning materials for all levels.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#">Home</a></li>
                    <li><a href="#papers">Past Papers</a></li>
                    <li><a href="#setbooks">Setbooks</a></li>
                    <li><a href="#">Subjects</a></li>
                    <li><a href="#contact">Contact Us</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Education Systems</h3>
                <ul class="footer-links">
                    <li><a href="#">KCPE</a></li>
                    <li><a href="#">KCSE</a></li>
                    <li><a href="#">CBC</a></li>
                    <li><a href="#">PP1 & PP2</a></li>
                </ul>
            </div>
            
            <div class="footer-section newsletter-section">
                <h3>Newsletter</h3>
                <p>Subscribe to get updates on new resources and educational tips.</p>
                <div class="newsletter-form">
                    <input type="email" placeholder="Your Email" class="newsletter-input">
                    <button class="btn btn-primary newsletter-btn">Subscribe</button>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; 2025 SomaFy Educational Resources. All rights reserved.</p>
        </div>
    </footer>

    <!-- Sign In Modal -->
    <div id="signin-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" data-modal="signin-modal">&times;</span>
            <h2>Sign In</h2>
            <form id="signin-form">
                <input type="text" id="signin-username" placeholder="Username or Email" required>
                <input type="password" id="signin-password" placeholder="Password" required>
                <button type="submit" class="btn btn-primary">Sign In</button>
            </form>
            <p>Don't have an account? <a href="#" id="show-register">Register</a></p>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" data-modal="register-modal">&times;</span>
            <h2>Register</h2>
            <form id="register-form">
                <input type="text" id="register-username" placeholder="Username" required>
                <input type="email" id="register-email" placeholder="Email" required>
                <input type="password" id="register-password" placeholder="Password" required>
                <button type="submit" class="btn btn-primary">Register</button>
            </form>
            <p>Already have an account? <a href="#" id="show-signin">Sign In</a></p>
        </div>
    </div>

    <!-- Download/Payment Modal -->
    <div id="download-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" data-modal="download-modal">&times;</span>
            <h2>Download Resource</h2>
            <form id="download-form">
                <input type="text" id="download-name" placeholder="Your Name" required>
                <input type="email" id="download-email" placeholder="Your Email" required>
                <input type="tel" id="download-phone" placeholder="Your Phone Number" required>
                <button type="submit" class="btn btn-primary">Continue</button>
            </form>
            <div id="download-modal-message"></div>
            <button id="download-pesapal-btn" class="btn btn-primary" style="display:none;">Pay with PesaPal</button>
        </div>
    </div>

    <script>
        // Simple and reliable modal functionality
        function openModal(modal) {
            if (modal) {
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(modal) {
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Modal close buttons
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    const modalId = this.getAttribute('data-modal');
                    const modal = document.getElementById(modalId);
                    if (modal) closeModal(modal);
                });
            });

            // Modal switching
            const showRegisterLink = document.getElementById('show-register');
            const showSigninLink = document.getElementById('show-signin');
            const signInLinkHeader = document.querySelector('.desktop-actions .sign-in-link'); // Targeting desktop sign-in
            const registerBtnHeader = document.querySelector('.desktop-actions .btn.btn-outline'); // Targeting desktop register

            if (showRegisterLink) {
                showRegisterLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeModal(document.getElementById('signin-modal'));
                    openModal(document.getElementById('register-modal'));
                });
            }
            
            if (showSigninLink) {
                showSigninLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeModal(document.getElementById('register-modal'));
                    openModal(document.getElementById('signin-modal'));
                });
            }

            // Open sign-in modal from header link
            if (signInLinkHeader) {
                signInLinkHeader.addEventListener('click', function(e) {
                    e.preventDefault();
                    openModal(document.getElementById('signin-modal'));
                });
            }

            // Open register modal from header button
            if (registerBtnHeader) {
                registerBtnHeader.addEventListener('click', function(e) {
                    e.preventDefault();
                    openModal(document.getElementById('register-modal'));
                });
            }

            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    closeModal(event.target);
                }
            });

            // Subject dropdown functionality
            const classSelect = document.getElementById('class-select');
            const subjectSelect = document.getElementById('subject-select');
            
            if (classSelect && subjectSelect) {
                classSelect.addEventListener('change', function() {
                    if (this.value) {
                        subjectSelect.disabled = false;
                        let subjects = [];
                        
                        if (this.value.includes('pp')) {
                            // CBC PP1 & PP2 subjects
                            subjects = [
                                { value: 'language_activities', label: 'Language Activities' },
                                { value: 'mathematical_activities', label: 'Mathematical Activities' },
                                { value: 'environmental_activities', label: 'Environmental Activities' },
                                { value: 'creative_activities', label: 'Creative Activities' },
                                { value: 'religious_activities', label: 'Religious Activities' }
                            ];
                        } else if (this.value.includes('std')) {
                            // KCPE subjects (Primary School)
                            subjects = [
                                { value: 'english', label: 'English' },
                                { value: 'kiswahili', label: 'Kiswahili' },
                                { value: 'mathematics', label: 'Mathematics' },
                                { value: 'science', label: 'Science' },
                                { value: 'social_studies', label: 'Social Studies' },
                                { value: 'religious_education', label: 'Religious Education' }
                            ];
                        } else if (this.value.includes('form')) {
                            // KCSE subjects (Secondary School)
                            subjects = [
                                { value: 'english', label: 'English' },
                                { value: 'kiswahili', label: 'Kiswahili' },
                                { value: 'mathematics', label: 'Mathematics' },
                                { value: 'biology', label: 'Biology' },
                                { value: 'chemistry', label: 'Chemistry' },
                                { value: 'physics', label: 'Physics' },
                                { value: 'history', label: 'History' },
                                { value: 'geography', label: 'Geography' },
                                { value: 'religious_education', label: 'Religious Education' },
                                { value: 'business_studies', label: 'Business Studies' },
                                { value: 'agriculture', label: 'Agriculture' },
                                { value: 'home_science', label: 'Home Science' },
                                { value: 'computer_studies', label: 'Computer Studies' }
                            ];
                        } else if (this.value.includes('grade')) {
                            // CBC Grades 1-12 subjects
                            subjects = [
                                { value: 'english', label: 'English' },
                                { value: 'kiswahili', label: 'Kiswahili' },
                                { value: 'kenya_sign_language', label: 'Kenya Sign Language' },
                                { value: 'mathematics', label: 'Mathematics' },
                                { value: 'religious_education', label: 'Religious Education' },
                                { value: 'environmental_activities', label: 'Environmental Activities' },
                                { value: 'creative_activities', label: 'Creative Activities' },
                                { value: 'science_technology', label: 'Science and Technology' },
                                { value: 'agriculture_nutrition', label: 'Agriculture and Nutrition' },
                                { value: 'social_studies', label: 'Social Studies' },
                                { value: 'arts_craft', label: 'Arts and Craft' },
                                { value: 'music', label: 'Music' },
                                { value: 'physical_health_education', label: 'Physical and Health Education' },
                                { value: 'integrated_science', label: 'Integrated Science' },
                                { value: 'pre_technical_career', label: 'Pre-Technical and Pre-Career Education' },
                                { value: 'business_studies', label: 'Business Studies' },
                                { value: 'health_education', label: 'Health Education' },
                                { value: 'life_skills_education', label: 'Life Skills Education' },
                                { value: 'computer_science', label: 'Computer Science' },
                                { value: 'home_science', label: 'Home Science' },
                                { value: 'community_service_learning', label: 'Community Service Learning' },
                                { value: 'physics', label: 'Physics' },
                                { value: 'chemistry', label: 'Chemistry' },
                                { value: 'biology', label: 'Biology' },
                                { value: 'fine_art', label: 'Fine Art' },
                                { value: 'performing_arts', label: 'Performing Arts' },
                                { value: 'sports_science', label: 'Sports Science' },
                                { value: 'history', label: 'History' },
                                { value: 'geography', label: 'Geography' },
                                { value: 'literature_english', label: 'Literature in English' }
                            ];
                        }
                        
                        subjectSelect.innerHTML = '<option value="">Select Subject</option>';
                        subjects.forEach(subject => {
                            subjectSelect.innerHTML += `<option value="${subject.value}">${subject.label}</option>`;
                        });
                    } else {
                        subjectSelect.disabled = true;
                        subjectSelect.innerHTML = '<option value="">First select a class/grade</option>';
                    }
                });
            }

            // Find Resources button
            const findResourcesBtn = document.getElementById('find-resources');
            if (findResourcesBtn) {
                findResourcesBtn.addEventListener('click', function() {
                    const selectedClass = classSelect ? classSelect.value : '';
                    const selectedSubject = subjectSelect ? subjectSelect.value : '';
                    
                    if (!selectedClass) {
                        // Use a custom message box instead of alert
                        showMessageBox('Please select a class/grade', 'error');
                        return;
                    }
                    
                    if (!selectedSubject) {
                        // Use a custom message box instead of alert
                        showMessageBox('Please select a subject', 'error');
                        return;
                    }
                    
                    // Redirect to resources page with query params
                    window.location.href = `resources.html?class=${encodeURIComponent(selectedClass)}&subject=${encodeURIComponent(selectedSubject)}`;
                });
            }

            // Slider functionality
            const slider = document.querySelector('.slider-container');
            const sliderNav = document.querySelector('.slider-nav');
            const prevBtn = document.querySelector('.slider-arrow.prev');
            const nextBtn = document.querySelector('.slider-arrow.next');
            let currentSlide = 0;
            let slideCount = 0; // Will be updated dynamically
            let sliderInterval;

            // Function to create slider dots and update slideCount
            function initializeSliderDots() {
                if (!slider || !sliderNav) return;
                const sliderItems = slider.querySelectorAll('.slider-item');
                slideCount = sliderItems.length;
                sliderNav.innerHTML = ''; // Clear existing dots

                if (slideCount > 0) {
                    for (let i = 0; i < slideCount; i++) {
                        const dot = document.createElement('span');
                        dot.classList.add('slider-dot');
                        dot.setAttribute('data-index', i);
                        dot.addEventListener('click', () => goToSlide(i));
                        sliderNav.appendChild(dot);
                    }
                    goToSlide(0); // Initialize first slide as active
                    startAutoSlide();
                }
            }

            function goToSlide(index) {
                if (!slider) return;
                currentSlide = index;
                slider.style.transform = `translateX(-${currentSlide * 100}%)`;
                
                // Update active dot
                const dots = sliderNav.querySelectorAll('.slider-dot');
                dots.forEach((dot, i) => {
                    dot.classList.toggle('active', i === currentSlide);
                });
            }
            
            function nextSlide() {
                currentSlide = (currentSlide + 1) % slideCount;
                goToSlide(currentSlide);
            }
            
            function prevSlide() {
                currentSlide = (currentSlide - 1 + slideCount) % slideCount;
                goToSlide(currentSlide);
            }

            function startAutoSlide() {
                clearInterval(sliderInterval); // Clear any existing interval
                sliderInterval = setInterval(nextSlide, 5000); // Auto slide every 5 seconds
            }

            // Event listeners for slider arrows
            if (prevBtn) prevBtn.addEventListener('click', () => { prevSlide(); startAutoSlide(); });
            if (nextBtn) nextBtn.addEventListener('click', () => { nextSlide(); startAutoSlide(); });

            // Initialize slider dots and auto-slide
            initializeSliderDots();


            // Hamburger menu functionality
            const hamburgerMenu = document.getElementById('hamburger-menu');
            const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
            const closeMobileMenu = document.getElementById('close-mobile-menu');
            const mobileMenuLinks = document.querySelectorAll('.mobile-nav ul li a'); // Get all links in mobile menu

            if (hamburgerMenu && mobileMenuOverlay && closeMobileMenu) {
                hamburgerMenu.addEventListener('click', function() {
                    mobileMenuOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden'; // Prevent scrolling
                });

                closeMobileMenu.addEventListener('click', function() {
                    mobileMenuOverlay.classList.remove('active');
                    document.body.style.overflow = ''; // Restore scrolling
                });

                // Close mobile menu when a link is clicked
                mobileMenuLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenuOverlay.classList.remove('active');
                        document.body.style.overflow = '';
                    });
                });

                // Close mobile menu when clicking outside the content
                mobileMenuOverlay.addEventListener('click', function(event) {
                    if (event.target === mobileMenuOverlay) {
                        mobileMenuOverlay.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });
            }

            // Dummy data for popular resources, past papers, and setbooks
            const popularResources = [
                { title: "KCSE Maths Paper 1 (2023)", type: "Past Paper", class: "Form 4", subject: "Mathematics", price: "Ksh 100", image: "https://placehold.co/300x200/0066cc/ffffff?text=Maths+Paper" },
                { title: "CBC Grade 5 Science Textbook", type: "Textbook", class: "Grade 5", subject: "Science", price: "Ksh 250", image: "https://placehold.co/300x200/2e8b57/ffffff?text=Science+Book" },
                { title: "The Pearl - John Steinbeck", type: "Setbook", class: "Form 3/4", subject: "English Literature", price: "Ksh 300", image: "https://placehold.co/300x200/8b4513/ffffff?text=The+Pearl" },
                { title: "KCPE English Revision (2022)", type: "Past Paper", class: "Standard 8", subject: "English", price: "Ksh 80", image: "https://placehold.co/300x200/ff9900/ffffff?text=English+Paper" }
            ];

            const pastPapers = [
                { title: "KCSE Biology Paper 2 (2023)", type: "Past Paper", class: "Form 4", subject: "Biology", price: "Ksh 100", image: "https://placehold.co/300x200/0066cc/ffffff?text=Biology+Paper" },
                { title: "KCPE Kiswahili (2023)", type: "Past Paper", class: "Standard 8", subject: "Kiswahili", price: "Ksh 80", image: "https://placehold.co/300x200/2e8b57/ffffff?text=Kiswahili+Paper" },
                { title: "CBC Grade 7 Integrated Science (2024)", type: "Past Paper", class: "Grade 7", subject: "Integrated Science", price: "Ksh 120", image: "https://placehold.co/300x200/ff9900/ffffff?text=Science+Exam" },
                { title: "KCSE Chemistry Paper 1 (2022)", type: "Past Paper", class: "Form 4", subject: "Chemistry", price: "Ksh 100", image: "https://placehold.co/300x200/8b4513/ffffff?text=Chemistry+Paper" }
            ];

            const setbooks = [
                { title: "Blossoms of the Savannah - H.R. Ole Kulet", type: "Setbook", class: "Form 3/4", subject: "English Literature", price: "Ksh 350", image: "https://placehold.co/300x200/0066cc/ffffff?text=Blossoms" },
                { title: "A Doll's House - Henrik Ibsen", type: "Setbook", class: "Form 3/4", subject: "English Literature", price: "Ksh 280", image: "https://placehold.co/300x200/2e8b57/ffffff?text=A+Doll's+House" },
                { title: "Fathers of Nations - Paul B. Vitabu", type: "Setbook", class: "Form 3/4", subject: "English Literature", price: "Ksh 320", image: "https://placehold.co/300x200/ff9900/ffffff?text=Fathers+of+Nations" }
            ];

            // Function to render book cards
            function renderBookCards(data, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;
                container.innerHTML = ''; // Clear existing content

                data.forEach(item => {
                    const card = document.createElement('div');
                    card.classList.add('book-card');
                    card.innerHTML = `
                        <div class="book-header">
                            <img src="${item.image}" alt="${item.title}" class="book-image">
                            <span class="book-badge">${item.type}</span>
                        </div>
                        <div class="book-info">
                            <h3>${item.title}</h3>
                            <div class="book-meta">
                                <span class="book-meta-left">
                                    <i class="fas fa-book"></i> ${item.class}
                                    <i class="fas fa-tag"></i> ${item.subject}
                                </span>
                                <span class="book-meta-right">
                                    <i class="fas fa-money-bill-wave"></i> ${item.price}
                                </span>
                            </div>
                            <p class="book-desc">A comprehensive ${item.type.toLowerCase()} for ${item.class} students, covering key concepts in ${item.subject}.</p>
                            <div class="book-actions">
                                <button class="btn btn-download" data-resource-title="${item.title}">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });

                // Add event listeners to download buttons
                container.querySelectorAll('.btn-download').forEach(button => {
                    button.addEventListener('click', function() {
                        const resourceTitle = this.getAttribute('data-resource-title');
                        openDownloadModal(resourceTitle);
                    });
                });
            }

            // Render initial cards
            renderBookCards(popularResources, 'popular-resources-grid');
            renderBookCards(pastPapers, 'past-papers-grid');
            renderBookCards(setbooks, 'setbooks-grid');

            // Function to open download modal
            function openDownloadModal(resourceTitle) {
                const downloadModal = document.getElementById('download-modal');
                const downloadModalMessage = document.getElementById('download-modal-message');
                const downloadPesapalBtn = document.getElementById('download-pesapal-btn');
                const downloadForm = document.getElementById('download-form');

                // Reset form and message
                downloadForm.reset();
                downloadModalMessage.textContent = '';
                downloadPesapalBtn.style.display = 'none';

                // Update modal title (optional, but good for context)
                downloadModal.querySelector('h2').textContent = `Download: ${resourceTitle}`;
                
                openModal(downloadModal);

                // Handle download form submission
                downloadForm.onsubmit = function(e) {
                    e.preventDefault();
                    downloadModalMessage.textContent = 'Processing your request...';
                    downloadPesapalBtn.style.display = 'block'; // Show PesaPal button after "Continue"
                };

                // Handle PesaPal button click
                downloadPesapalBtn.onclick = function() {
                    downloadModalMessage.textContent = 'Redirecting to PesaPal for payment...';
                    // In a real application, you would integrate with PesaPal API here
                    // For now, simulate a payment and download
                    setTimeout(() => {
                        downloadModalMessage.textContent = 'Payment successful! Your download will start shortly.';
                        // Simulate download
                        setTimeout(() => {
                            // In a real app, trigger actual file download
                            console.log(`Downloading ${resourceTitle}...`);
                            closeModal(downloadModal);
                            showMessageBox('Download started!', 'success');
                        }, 1500);
                    }, 2000);
                };
            }

            // Custom Message Box (instead of alert)
            function showMessageBox(message, type = 'info') {
                const existingMessageBox = document.getElementById('custom-message-box');
                if (existingMessageBox) {
                    existingMessageBox.remove();
                }

                const messageBox = document.createElement('div');
                messageBox.id = 'custom-message-box';
                messageBox.textContent = message;
                messageBox.classList.add('message-box', type);

                document.body.appendChild(messageBox);

                // Animate in
                setTimeout(() => {
                    messageBox.style.opacity = '1';
                    messageBox.style.transform = 'translate(-50%, 0)';
                }, 10);

                // Animate out and remove after 3 seconds
                setTimeout(() => {
                    messageBox.style.opacity = '0';
                    messageBox.style.transform = 'translate(-50%, -20px)';
                    messageBox.addEventListener('transitionend', () => messageBox.remove());
                }, 3000);
            }

            // Add basic styling for the message box
            const style = document.createElement('style');
            style.innerHTML = `
                .message-box {
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translate(-50%, -20px);
                    background-color: #333;
                    color: white;
                    padding: 15px 25px;
                    border-radius: 8px;
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                    z-index: 10001;
                    opacity: 0;
                    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
                    font-family: 'Open Sans', sans-serif;
                    font-size: 1rem;
                    text-align: center;
                }
                .message-box.success {
                    background-color: var(--savannah-green);
                }
                .message-box.error {
                    background-color: #dc3545;
                }
                .message-box.info {
                    background-color: var(--nairobi-blue);
                }
            `;
            document.head.appendChild(style);
        });
    </script>
    <script src="script.js"></script>
</body>
</html>
